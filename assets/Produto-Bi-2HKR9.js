import{a as V}from"./axios-B7aoVuMY.js";import{N as G}from"./NavBar-BzkWyl0J.js";import{C as M}from"./ConfirmButton-YYOAErrP.js";import{_ as F,r as w,o as g,t as C,b as a,w as o,a as l,l as h,d as s,C as q,j as B,i as T,g as d,K as P,L as R,M as O,f,u as E,H as p,z as i,N as z,p as v,O as D,F as j,P as K,c as k,U as H,S as N,e as U,J as x,T as A}from"./index-C6aeZltw.js";import{U as Y}from"./utilsService-D61Juas6.js";const J={name:"NovoProduto",components:{ConfirmButton:M},props:{onSubmit:Function,currentItem:{type:Object}},data:()=>({isSubmitting:!1,unidade:[{type:"G",value:"G"},{type:"Kg",value:"Kg"},{type:"T",value:"T"},{type:"L",value:"L"},{type:"Ml",value:"Ml"},{type:"UND",value:"Und"},{type:"Maço",value:"Maço"},{type:"Caixas",value:"Caixas"},{type:"Pacotes",value:"Pacotes"},{type:"Fardos",value:"Fardos"},{type:"Sacos",value:"Sacos"}],requiredField:[e=>e!=null&&e!==""||"Obrigatório"]}),computed:{isFormValid(){return!!(this.currentItem.descricao&&this.currentItem.unidade)}},methods:{async localOnSubmit(){this.currentItem.descricao=this.currentItem.descricao.toUpperCase();try{const e={...this.currentItem};console.log(e),this.onSubmit(e)}catch(e){console.log("Erro: ",e)}}},mounted(){}},Q={class:"pa-4 pr-12 pl-12"},W={class:"grid-container"};function X(e,t,r,b,y,n){const c=w("ConfirmButton");return g(),C("div",Q,[a(T,{onSubmit:B(n.localOnSubmit,["prevent"]),ref:"formRef"},{default:o(()=>[l("div",W,[a(h,{class:"flex-item-nome",density:"compact",name:"nome",modelValue:r.currentItem.descricao,"onUpdate:modelValue":t[0]||(t[0]=u=>r.currentItem.descricao=u),variant:"outlined",rules:e.requiredField},{label:o(()=>t[2]||(t[2]=[l("span",null,[s("Descrição "),l("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["modelValue","rules"]),a(q,{density:"compact",name:"unidade",items:e.unidade,"item-title":"type","item-value":"value",modelValue:r.currentItem.unidade,"onUpdate:modelValue":t[1]||(t[1]=u=>r.currentItem.unidade=u),variant:"outlined",rules:e.requiredField,clearable:""},{label:o(()=>t[3]||(t[3]=[l("span",null,[s("Unidade "),l("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["items","modelValue","rules"])])]),_:1},8,["onSubmit"]),a(f,{class:"justify-end dense pt-6"},{default:o(()=>[a(d,{class:"text-end"},{default:o(()=>[a(P,{location:"top",disabled:n.isFormValid},{activator:o(({props:u})=>[l("span",R(O(u)),[a(c,{color:n.isFormValid?"success":"grey",onConfirm:n.localOnSubmit,loading:e.isSubmitting,disabled:!n.isFormValid||e.isSubmitting},{default:o(()=>t[4]||(t[4]=[s("Salvar")])),_:1},8,["color","onConfirm","loading","disabled"])],16)]),default:o(()=>[t[5]||(t[5]=l("span",null,"Preencha todos os campos obrigatórios (*) para habilitar o botão",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])}const Z=F(J,[["render",X],["__scopeId","data-v-a942a59f"]]),$={name:"EditProduto",components:{ConfirmButton:M},props:{onSubmit:Function,currentItem:{type:Object}},data:()=>({isSubmitting:!1,unidade:[{type:"G",value:"G"},{type:"Kg",value:"Kg"},{type:"T",value:"T"},{type:"L",value:"L"},{type:"Ml",value:"Ml"},{type:"UND",value:"Und"},{type:"Maço",value:"Maço"},{type:"Caixas",value:"Caixas"},{type:"Pacotes",value:"Pacotes"},{type:"Fardos",value:"Fardos"},{type:"Sacos",value:"Sacos"}],requiredField:[e=>e!=null&&e!==""||"Obrigatório"]}),computed:{isFormValid(){return!!(this.currentItem.descricao&&this.currentItem.unidade)}},methods:{async localOnSubmit(){this.currentItem.descricao=this.currentItem.descricao.toUpperCase();try{const e={...this.currentItem};this.onSubmit(e)}catch(e){console.log("Erro: ",e)}}}},_={class:"pa-4 pr-12 pl-12"},tt={class:"grid-container"};function et(e,t,r,b,y,n){const c=w("ConfirmButton");return g(),C("div",_,[a(T,{onSubmit:B(n.localOnSubmit,["prevent"]),ref:"formRef"},{default:o(()=>[l("div",tt,[a(h,{class:"flex-item-nome",density:"compact",name:"nome",modelValue:r.currentItem.descricao,"onUpdate:modelValue":t[0]||(t[0]=u=>r.currentItem.descricao=u),variant:"outlined",rules:e.requiredField,clearable:""},{label:o(()=>t[2]||(t[2]=[l("span",null,[s("Descrição "),l("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["modelValue","rules"]),a(q,{density:"compact",name:"unidade",items:e.unidade,"item-title":"type","item-value":"value",modelValue:r.currentItem.unidade,"onUpdate:modelValue":t[1]||(t[1]=u=>r.currentItem.unidade=u),variant:"outlined",rules:e.requiredField,clearable:""},{label:o(()=>t[3]||(t[3]=[l("span",null,[s("Unidade "),l("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["items","modelValue","rules"])])]),_:1},8,["onSubmit"]),a(f,{class:"justify-end dense pt-6"},{default:o(()=>[a(d,{class:"text-end"},{default:o(()=>[a(P,{location:"top",disabled:n.isFormValid},{activator:o(({props:u})=>[l("span",R(O(u)),[a(c,{color:n.isFormValid?"success":"grey",onConfirm:n.localOnSubmit,loading:e.isSubmitting,disabled:!n.isFormValid||e.isSubmitting},{default:o(()=>t[4]||(t[4]=[s("Salvar")])),_:1},8,["color","onConfirm","loading","disabled"])],16)]),default:o(()=>[t[5]||(t[5]=l("span",null,"Preencha todos os campos obrigatórios (*) para habilitar o botão",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])}const ot=F($,[["render",et],["__scopeId","data-v-4c71bd3d"]]),at={name:"ProdutorExpand",props:{produtorData:Object},data:()=>({productors:[],headers:[{title:"Arquivo",align:"start",sortable:!0,value:"fileName"},{title:"Tipo",align:"start",sortable:!0,value:"fileType"},{title:"Baixar",align:"start",sortable:!0,value:"download"},{title:"Remover",align:"start",sortable:!0,value:"remove"}]}),methods:{getAge(){var y;const e=new Date,t=new Date((y=this.produtorData)==null?void 0:y.dataNascimento);let r=e.getFullYear()-t.getFullYear();const b=e.getMonth()-t.getMonth();(b<0||b===0&&e.getDate()<t.getDate())&&r--,this.produtorData.dataNascimento=r},downloadFile(e){const t=`http://localhost:8080/document/download/${e==null?void 0:e.fileName}`,r=document.createElement("a");r.href=t,r.download=e.fileName,document.body.appendChild(r),r.click(),document.body.removeChild(r)},async deleteFile(e){const t=E();console.log("Id do arquivo: ",e.id);try{const r=await V.delete(`/document/delete/${e.id}/${this.produtorData.id}`);if(r.status!==204)throw new Error("Erro: ",r.status);t.success("Arquivo removido com sucesso!")}catch(r){t.error("Erro ao remover arquivo: ",r)}},async getProductors(){try{const e=await V.get("/public/produtores");console.log(e.data),Array.isArray(e.data)?this.productors=e.data:(console.log("A resposta da API não é um Array"),this.productors=[])}catch(e){console.log("Error: ",e),this.productors=[]}}},mounted(){var e;this.getAge(),console.log((e=this.produtorData)==null?void 0:e.documentos)}},lt={align:"start",class:"pa-2"},rt={align:"start",class:"pa-2"},st={align:"start",class:"pa-2"},dt={align:"start",class:"pa-2"};function nt(e,t,r,b,y,n){return g(),C(j,null,[t[29]||(t[29]=l("h3",{class:"mt-2"},"Detalhes de Produtor",-1)),l("h4",lt,[t[1]||(t[1]=s(" Dados Pessoais ")),a(p,null,{default:o(()=>t[0]||(t[0]=[s("mdi-file-account")])),_:1})]),a(f,{dense:"",style:{height:"150px"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"3",align:"start",class:"h-50"},{default:o(()=>[t[2]||(t[2]=l("h4",null,"Nome:",-1)),l("p",null,i(r.produtorData.nome),1)]),_:1}),a(d,{cols:"1",align:"start",class:"h-50"},{default:o(()=>[t[3]||(t[3]=l("h4",null,"Idade:",-1)),l("p",null,i(r.produtorData.dataNascimento),1)]),_:1}),a(d,{cols:"3",align:"start",class:"h-50"},{default:o(()=>[t[4]||(t[4]=l("h4",null,"Email:",-1)),l("p",null,i(r.produtorData.email),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[t[5]||(t[5]=l("h4",null,"Contato:",-1)),l("p",null,i(r.produtorData.contato),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[t[6]||(t[6]=l("h4",null,"CPF:",-1)),l("p",null,i(r.produtorData.cpf),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[t[7]||(t[7]=l("h4",null,"RG:",-1)),l("p",null,i(r.produtorData.rg),1)]),_:1})]),_:1}),l("h4",rt,[t[9]||(t[9]=s(" Endereço ")),a(p,null,{default:o(()=>t[8]||(t[8]=[s("mdi-home")])),_:1})]),a(f,{dense:"",style:{height:"100px"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"1",align:"start",class:"h-75"},{default:o(()=>[t[10]||(t[10]=l("h4",null,"Estado:",-1)),l("p",null,i(r.produtorData.estado),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[11]||(t[11]=l("h4",null,"Município:",-1)),l("p",null,i(r.produtorData.municipio),1)]),_:1}),a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[12]||(t[12]=l("h4",null,"Endereço:",-1)),l("p",null,i(r.produtorData.endereco),1)]),_:1}),a(d,{cols:"1",align:"start",class:"h-75"},{default:o(()=>[t[13]||(t[13]=l("h4",null,"CEP:",-1)),l("p",null,i(r.produtorData.cep),1)]),_:1})]),_:1}),a(f,{dense:"",style:{height:"50vh",width:"452px","margin-top":"34px","border-top":"2px solid #CCCCCC"},class:"float-end"},{default:o(()=>[a(z,{items:r.produtorData.documentos,headers:e.headers,class:"h-75",align:"start","items-per-page":3,"fixed-header":!0},{top:o(()=>t[14]||(t[14]=[l("h4",{align:"center",class:"pa-2"}," Documentos do produtor ",-1)])),"item.download":o(({item:c})=>[a(P,{location:"top"},{activator:o(({props:u})=>[a(v,D({icon:""},u,{onClick:S=>n.downloadFile(c),class:"elevation-0"}),{default:o(()=>[a(p,{color:"primary"},{default:o(()=>t[15]||(t[15]=[s("mdi-download-box")])),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[t[16]||(t[16]=l("span",null,"Clique para baixar um arquivo",-1))]),_:2},1024)]),"item.remove":o(({item:c})=>[a(P,{location:"top"},{activator:o(({props:u})=>[a(v,D({icon:""},u,{onClick:S=>n.deleteFile(c),class:"elevation-0"}),{default:o(()=>[a(p,{color:"red"},{default:o(()=>t[17]||(t[17]=[s("mdi-delete")])),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[t[18]||(t[18]=l("span",null,"Clique para remover um arquivo",-1))]),_:2},1024)]),_:2},1032,["items","headers"])]),_:1}),l("h4",st,[t[20]||(t[20]=s(" Dados Bancários ")),a(p,null,{default:o(()=>t[19]||(t[19]=[s("mdi-bank")])),_:1})]),a(f,{dense:"",style:{height:"100px",width:"50vw"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[21]||(t[21]=l("h4",null,"Banco:",-1)),l("p",null,i(r.produtorData.banco),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[22]||(t[22]=l("h4",null,"Agência:",-1)),l("p",null,i(r.produtorData.agencia),1)]),_:1}),a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[23]||(t[23]=l("h4",null,"Tipo de Conta:",-1)),l("p",null,i(r.produtorData.tipoConta),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[24]||(t[24]=l("h4",null,"Conta:",-1)),l("p",null,i(r.produtorData.conta),1)]),_:1})]),_:1}),l("h4",dt,[t[26]||(t[26]=s(" Dados da CAF ")),a(p,null,{default:o(()=>t[25]||(t[25]=[s("mdi-text-box-multiple-outline")])),_:1})]),a(f,{dense:"",style:{height:"120px",width:"50vw"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[27]||(t[27]=l("h4",null,"CAF:",-1)),l("p",null,i(r.produtorData.caf),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[28]||(t[28]=l("h4",null,"Validade da CAF:",-1)),l("p",null,i(r.produtorData.validadeCaf),1)]),_:1})]),_:1})],64)}const it=F(at,[["render",nt]]),ut={name:"CadastroProdutor",components:{NavBar:G,NovoProduto:Z,ProdutorExpand:it,EditProdutor:ot},data:()=>({dialog:{create:!1,update:!1},search:"",singleExpand:!1,showFilters:!1,products:[],headers:[{text:"Editar",align:"center",value:"edit"},{title:"Descrição do Produto",align:"center",sortable:!0,value:"descricao"},{title:"Unidade",align:"center",sortable:!0,value:"unidade"},{title:"Preço Médio",align:"center",sortable:!0,value:"precoMedio"}],newItem:{},selectedRow:{},expanded:[]}),computed:{filteredProductors(){return this.products}},methods:{formatPrice(e){return e=Y.formatReal(e),e},async getProducts(){try{const e=await V.get("/public/produtos");console.log(e.data),Array.isArray(e.data)?this.products=e.data:(console.log("A resposta da API não é um Array"),this.products=[])}catch(e){console.log("Error: ",e),this.products=[]}},async createProduct(e){const t=E();console.log(e);try{const r=await V.post("/public/produtos/produto",e);if(console.log(r.data),r.status!==201)throw new Error(`Erro: ${r.status}`);t.success("Produto cadastrado com sucesso!")}catch(r){console.error("Erro: ",r),t.error("Erro ao cadastrar produto: ",r)}finally{this.dialog=!1,this.getProducts()}},async updateProduct(e){const t=E();try{const r=await V.put(`/public/produtos/produto/${e.id}`,e);if(console.log(r.data),r.status!==200)throw new Error(`Erro: ${r.status}`);t.success("Produto atualizado com sucesso!")}catch(r){console.error("Erro: ",r),t.error("Erro ao atualizar produto: ",r)}finally{this.dialog.update=!1,this.getProducts()}},onSelectRow(e,t){this.selectedRow={...e},this.dialog[t]=!0}},mounted(){this.getProducts()}},mt={key:0},pt={key:1};function ct(e,t,r,b,y,n){const c=w("NavBar"),u=w("NovoProduto"),S=w("EditProdutor");return g(),C(j,null,[a(c),t[19]||(t[19]=l("h1",{style:{color:"#57a340","margin-top":"10px",padding:"30px","font-size":"3rem"}},"Cadastro de Produtos",-1)),a(f,{justify:"center",class:"pr-2"},{default:o(()=>[a(d,{cols:"12"},{default:o(()=>[a(z,{items:n.filteredProductors,headers:e.headers,search:e.search,"single-expand":"",expanded:e.expanded,"onUpdate:expanded":t[3]||(t[3]=m=>e.expanded=m),"fixed-header":!0,height:"700px"},{top:o(()=>[a(f,{class:"mt-2 mb-8 mx-3"},{default:o(()=>[a(d,{cols:"5"},{default:o(()=>[a(h,{class:"border rounded",dense:"",outlined:"","hide-details":"",modelValue:e.search,"onUpdate:modelValue":t[0]||(t[0]=m=>e.search=m),label:"Pesquisar","append-inner-icon":"mdi-magnify",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{class:"text-end",cols:"2"},{default:o(()=>[a(K,{location:"top start",bordered:"",overlap:""},{default:o(()=>[a(v,{class:"elevation-0",onClick:t[1]||(t[1]=m=>e.showFilters=!e.showFilters)},{default:o(()=>[e.showFilters?(g(),k(p,{key:1,left:"",size:"25px"},{default:o(()=>t[9]||(t[9]=[s("mdi-filter-off")])),_:1})):(g(),k(p,{key:0,size:"25px",left:""},{default:o(()=>t[8]||(t[8]=[s("mdi-filter")])),_:1})),t[10]||(t[10]=s(" FILTROS "))]),_:1})]),_:1})]),_:1}),a(d,{class:"button-group mr-4",align:"end"},{default:o(()=>[a(P,{top:""},{activator:o(({on:m,attrs:I})=>[a(v,D({color:"success",class:"elevation-3 compact-btn ml-3","min-width":"25%",onClick:t[2]||(t[2]=L=>e.dialog.create=!0)},I,H(m)),{default:o(()=>[a(p,{small:"",class:"compact-icon",left:""},{default:o(()=>t[11]||(t[11]=[s("mdi-plus")])),_:1}),t[12]||(t[12]=l("div",{class:"d-flex flex-column compact-btn-text",style:{"font-size":"0.6rem"}},[l("span",null,"Novo"),s(),l("span",null,"Produto")],-1))]),_:2},1040)]),default:o(()=>[t[13]||(t[13]=l("span",null,"Clique para adicionar um produto",-1))]),_:1})]),_:1})]),_:1})]),"item.edit":o(({item:m})=>[a(P,{location:"top"},{activator:o(({props:I})=>[a(v,D({icon:""},I,{onClick:L=>n.onSelectRow(m,"update"),class:"elevation-0"}),{default:o(()=>[a(p,{color:"green"},{default:o(()=>t[14]||(t[14]=[s("mdi-pencil")])),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[t[15]||(t[15]=l("span",null,"Clique para editar um Produtor",-1))]),_:2},1024)]),"item.precoMedio":o(({item:m})=>[m.precoMedio!==null?(g(),C("span",mt,i(n.formatPrice(m.precoMedio)),1)):(g(),C("span",pt,"-"))]),_:2},1032,["items","headers","search","expanded"]),a(N,{modelValue:e.dialog.create,"onUpdate:modelValue":t[5]||(t[5]=m=>e.dialog.create=m)},{default:o(()=>[a(U,{class:"card-form align-self-center",width:"60%"},{default:o(()=>[a(x,{class:"sticky-title title-border"},{default:o(()=>[t[17]||(t[17]=s(" Cadastro de Produto ")),a(A),a(v,{icon:"",class:"btn-close elevation-0",onClick:t[4]||(t[4]=m=>e.dialog.create=!e.dialog.create)},{default:o(()=>[a(p,{prepend:""},{default:o(()=>t[16]||(t[16]=[s(" mdi-close ")])),_:1})]),_:1})]),_:1}),a(u,{currentItem:e.newItem,onSubmit:n.createProduct,files:e.files},null,8,["currentItem","onSubmit","files"])]),_:1})]),_:1},8,["modelValue"]),a(N,{modelValue:e.dialog.update,"onUpdate:modelValue":t[7]||(t[7]=m=>e.dialog.update=m)},{default:o(()=>[a(U,{class:"card-form align-self-center",width:"60%"},{default:o(()=>[a(x,{class:"sticky-title title-border"},{default:o(()=>[s(" Editar Produtor: "+i(e.selectedRow.id)+" ",1),a(A),a(v,{icon:"",class:"btn-close elevation-0",onClick:t[6]||(t[6]=m=>e.dialog.update=!e.dialog.update)},{default:o(()=>[a(p,{prepend:""},{default:o(()=>t[18]||(t[18]=[s(" mdi-close ")])),_:1})]),_:1})]),_:1}),a(S,{currentItem:e.selectedRow,onSubmit:n.updateProduct,files:e.files},null,8,["currentItem","onSubmit","files"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})],64)}const Ct=F(ut,[["render",ct],["__scopeId","data-v-e2037b27"]]);export{Ct as default};
