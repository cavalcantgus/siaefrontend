import{a as w}from"./axios-B7aoVuMY.js";import{N as K}from"./NavBar-BShwAm9u.js";import{C as q,B as H}from"./BtnComeBack-B8TkPntt.js";import{_ as S,r as C,o as g,t as V,b as a,w as o,a as r,l as D,d as s,C as x,j as M,i as T,g as d,K as P,L as O,M as R,f,u as h,H as p,z as u,N as L,p as v,O as I,F as G,P as Y,c as k,U as J,S as B,e as N,J as A,T as U}from"./index-fQIQvg1H.js";import{U as Q}from"./utilsService-D61Juas6.js";const W={name:"NovoProduto",components:{ConfirmButton:q},props:{onSubmit:Function,currentItem:{type:Object},dialogAtivo:{type:Boolean,required:!0}},data:()=>({isSubmitting:!1,unidade:[{type:"G",value:"G"},{type:"KG",value:"KG"},{type:"T",value:"T"},{type:"L",value:"L"},{type:"ML",value:"ML"},{type:"UND",value:"UND"},{type:"Maço",value:"Maço"},{type:"Caixas",value:"Caixas"},{type:"Pacotes",value:"Pacotes"},{type:"Fardos",value:"Fardos"},{type:"Sacos",value:"Sacos"}],requiredField:[t=>t!=null&&t!==""||"Obrigatório"]}),watch:{dialogAtivo(t){t||this.resetState()}},computed:{isFormValid(){return!!(this.currentItem.descricao&&this.currentItem.unidade)}},methods:{resetState(){Object.keys(this.currentItem).forEach(t=>{this.currentItem[t]=null})},async localOnSubmit(){this.currentItem.descricao=this.currentItem.descricao.toUpperCase();try{const t={...this.currentItem};console.log(t),this.onSubmit(t)}catch(t){console.log("Erro: ",t)}}},mounted(){}},X={class:"pa-4 pr-12 pl-12"},Z={class:"grid-container"};function $(t,e,l,b,y,i){const c=C("ConfirmButton");return g(),V("div",X,[a(T,{onSubmit:M(i.localOnSubmit,["prevent"]),ref:"formRef"},{default:o(()=>[r("div",Z,[a(D,{class:"flex-item-nome",density:"compact",name:"nome",modelValue:l.currentItem.descricao,"onUpdate:modelValue":e[0]||(e[0]=n=>l.currentItem.descricao=n),variant:"outlined",rules:t.requiredField},{label:o(()=>e[3]||(e[3]=[r("span",null,[s("Descrição "),r("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["modelValue","rules"]),a(D,{density:"compact",name:"nome",label:"Especificação",modelValue:l.currentItem.especificacao,"onUpdate:modelValue":e[1]||(e[1]=n=>l.currentItem.especificacao=n),variant:"outlined"},null,8,["modelValue"]),a(x,{density:"compact",name:"unidade",items:t.unidade,"item-title":"type","item-value":"value",modelValue:l.currentItem.unidade,"onUpdate:modelValue":e[2]||(e[2]=n=>l.currentItem.unidade=n),variant:"outlined",rules:t.requiredField,clearable:""},{label:o(()=>e[4]||(e[4]=[r("span",null,[s("Unidade "),r("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["items","modelValue","rules"])])]),_:1},8,["onSubmit"]),a(f,{class:"justify-end dense pt-6"},{default:o(()=>[a(d,{class:"text-end"},{default:o(()=>[a(P,{location:"top",disabled:i.isFormValid},{activator:o(({props:n})=>[r("span",O(R(n)),[a(c,{color:i.isFormValid?"success":"grey",onConfirm:i.localOnSubmit,loading:t.isSubmitting,disabled:!i.isFormValid||t.isSubmitting},{default:o(()=>e[5]||(e[5]=[s("Salvar")])),_:1},8,["color","onConfirm","loading","disabled"])],16)]),default:o(()=>[e[6]||(e[6]=r("span",null,"Preencha todos os campos obrigatórios (*) para habilitar o botão",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])}const _=S(W,[["render",$],["__scopeId","data-v-5dd153e8"]]),ee={name:"EditProduto",components:{ConfirmButton:q},props:{onSubmit:Function,currentItem:{type:Object}},data:()=>({isSubmitting:!1,unidade:[{type:"G",value:"G"},{type:"KG",value:"KG"},{type:"T",value:"T"},{type:"L",value:"L"},{type:"ML",value:"ML"},{type:"UND",value:"UND"},{type:"Maço",value:"Maço"},{type:"Caixas",value:"Caixas"},{type:"Pacotes",value:"Pacotes"},{type:"Fardos",value:"Fardos"},{type:"Sacos",value:"Sacos"}],requiredField:[t=>t!=null&&t!==""||"Obrigatório"]}),computed:{isFormValid(){return!!(this.currentItem.descricao&&this.currentItem.unidade)}},methods:{async localOnSubmit(){this.currentItem.descricao=this.currentItem.descricao.toUpperCase();try{const t={...this.currentItem};this.onSubmit(t)}catch(t){console.log("Erro: ",t)}}}},te={class:"pa-4 pr-12 pl-12"},oe={class:"grid-container"};function ae(t,e,l,b,y,i){const c=C("ConfirmButton");return g(),V("div",te,[a(T,{onSubmit:M(i.localOnSubmit,["prevent"]),ref:"formRef"},{default:o(()=>[r("div",oe,[a(D,{class:"flex-item-nome",density:"compact",name:"nome",modelValue:l.currentItem.descricao,"onUpdate:modelValue":e[0]||(e[0]=n=>l.currentItem.descricao=n),variant:"outlined",rules:t.requiredField,clearable:""},{label:o(()=>e[3]||(e[3]=[r("span",null,[s("Descrição "),r("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["modelValue","rules"]),a(D,{density:"compact",name:"nome",label:"Especificação",modelValue:l.currentItem.especificacao,"onUpdate:modelValue":e[1]||(e[1]=n=>l.currentItem.especificacao=n),variant:"outlined"},null,8,["modelValue"]),a(x,{density:"compact",name:"unidade",items:t.unidade,"item-title":"type","item-value":"value",modelValue:l.currentItem.unidade,"onUpdate:modelValue":e[2]||(e[2]=n=>l.currentItem.unidade=n),variant:"outlined",rules:t.requiredField,clearable:""},{label:o(()=>e[4]||(e[4]=[r("span",null,[s("Unidade "),r("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["items","modelValue","rules"])])]),_:1},8,["onSubmit"]),a(f,{class:"justify-end dense pt-6"},{default:o(()=>[a(d,{class:"text-end"},{default:o(()=>[a(P,{location:"top",disabled:i.isFormValid},{activator:o(({props:n})=>[r("span",O(R(n)),[a(c,{color:i.isFormValid?"success":"grey",onConfirm:i.localOnSubmit,loading:t.isSubmitting,disabled:!i.isFormValid||t.isSubmitting},{default:o(()=>e[5]||(e[5]=[s("Salvar")])),_:1},8,["color","onConfirm","loading","disabled"])],16)]),default:o(()=>[e[6]||(e[6]=r("span",null,"Preencha todos os campos obrigatórios (*) para habilitar o botão",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])}const le=S(ee,[["render",ae],["__scopeId","data-v-ad07478b"]]),re={name:"ProdutorExpand",props:{produtorData:Object},data:()=>({productors:[],headers:[{title:"Arquivo",align:"start",sortable:!0,value:"fileName"},{title:"Tipo",align:"start",sortable:!0,value:"fileType"},{title:"Baixar",align:"start",sortable:!0,value:"download"},{title:"Remover",align:"start",sortable:!0,value:"remove"}]}),methods:{getAge(){var y;const t=new Date,e=new Date((y=this.produtorData)==null?void 0:y.dataNascimento);let l=t.getFullYear()-e.getFullYear();const b=t.getMonth()-e.getMonth();(b<0||b===0&&t.getDate()<e.getDate())&&l--,this.produtorData.dataNascimento=l},downloadFile(t){const e=`http://localhost:8080/document/download/${t==null?void 0:t.fileName}`,l=document.createElement("a");l.href=e,l.download=t.fileName,document.body.appendChild(l),l.click(),document.body.removeChild(l)},async deleteFile(t){const e=h();console.log("Id do arquivo: ",t.id);try{const l=await w.delete(`/document/delete/${t.id}/${this.produtorData.id}`);if(l.status!==204)throw new Error("Erro: ",l.status);e.success("Arquivo removido com sucesso!")}catch(l){e.error("Erro ao remover arquivo: ",l)}},async getProductors(){try{const t=await w.get("/public/produtores");console.log(t.data),Array.isArray(t.data)?this.productors=t.data:(console.log("A resposta da API não é um Array"),this.productors=[])}catch(t){console.log("Error: ",t),this.productors=[]}}},mounted(){var t;this.getAge(),console.log((t=this.produtorData)==null?void 0:t.documentos)}},se={align:"start",class:"pa-2"},de={align:"start",class:"pa-2"},ne={align:"start",class:"pa-2"},ie={align:"start",class:"pa-2"};function ue(t,e,l,b,y,i){return g(),V(G,null,[e[29]||(e[29]=r("h3",{class:"mt-2"},"Detalhes de Produtor",-1)),r("h4",se,[e[1]||(e[1]=s(" Dados Pessoais ")),a(p,null,{default:o(()=>e[0]||(e[0]=[s("mdi-file-account")])),_:1})]),a(f,{dense:"",style:{height:"150px"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"3",align:"start",class:"h-50"},{default:o(()=>[e[2]||(e[2]=r("h4",null,"Nome:",-1)),r("p",null,u(l.produtorData.nome),1)]),_:1}),a(d,{cols:"1",align:"start",class:"h-50"},{default:o(()=>[e[3]||(e[3]=r("h4",null,"Idade:",-1)),r("p",null,u(l.produtorData.dataNascimento),1)]),_:1}),a(d,{cols:"3",align:"start",class:"h-50"},{default:o(()=>[e[4]||(e[4]=r("h4",null,"Email:",-1)),r("p",null,u(l.produtorData.email),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[e[5]||(e[5]=r("h4",null,"Contato:",-1)),r("p",null,u(l.produtorData.contato),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[e[6]||(e[6]=r("h4",null,"CPF:",-1)),r("p",null,u(l.produtorData.cpf),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[e[7]||(e[7]=r("h4",null,"RG:",-1)),r("p",null,u(l.produtorData.rg),1)]),_:1})]),_:1}),r("h4",de,[e[9]||(e[9]=s(" Endereço ")),a(p,null,{default:o(()=>e[8]||(e[8]=[s("mdi-home")])),_:1})]),a(f,{dense:"",style:{height:"100px"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"1",align:"start",class:"h-75"},{default:o(()=>[e[10]||(e[10]=r("h4",null,"Estado:",-1)),r("p",null,u(l.produtorData.estado),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[e[11]||(e[11]=r("h4",null,"Município:",-1)),r("p",null,u(l.produtorData.municipio),1)]),_:1}),a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[e[12]||(e[12]=r("h4",null,"Endereço:",-1)),r("p",null,u(l.produtorData.endereco),1)]),_:1}),a(d,{cols:"1",align:"start",class:"h-75"},{default:o(()=>[e[13]||(e[13]=r("h4",null,"CEP:",-1)),r("p",null,u(l.produtorData.cep),1)]),_:1})]),_:1}),a(f,{dense:"",style:{height:"50vh",width:"452px","margin-top":"34px","border-top":"2px solid #CCCCCC"},class:"float-end"},{default:o(()=>[a(L,{items:l.produtorData.documentos,headers:t.headers,class:"h-75",align:"start","items-per-page":3,"fixed-header":!0},{top:o(()=>e[14]||(e[14]=[r("h4",{align:"center",class:"pa-2"}," Documentos do produtor ",-1)])),"item.download":o(({item:c})=>[a(P,{location:"top"},{activator:o(({props:n})=>[a(v,I({icon:""},n,{onClick:F=>i.downloadFile(c),class:"elevation-0"}),{default:o(()=>[a(p,{color:"primary"},{default:o(()=>e[15]||(e[15]=[s("mdi-download-box")])),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[e[16]||(e[16]=r("span",null,"Clique para baixar um arquivo",-1))]),_:2},1024)]),"item.remove":o(({item:c})=>[a(P,{location:"top"},{activator:o(({props:n})=>[a(v,I({icon:""},n,{onClick:F=>i.deleteFile(c),class:"elevation-0"}),{default:o(()=>[a(p,{color:"red"},{default:o(()=>e[17]||(e[17]=[s("mdi-delete")])),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[e[18]||(e[18]=r("span",null,"Clique para remover um arquivo",-1))]),_:2},1024)]),_:2},1032,["items","headers"])]),_:1}),r("h4",ne,[e[20]||(e[20]=s(" Dados Bancários ")),a(p,null,{default:o(()=>e[19]||(e[19]=[s("mdi-bank")])),_:1})]),a(f,{dense:"",style:{height:"100px",width:"50vw"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[e[21]||(e[21]=r("h4",null,"Banco:",-1)),r("p",null,u(l.produtorData.banco),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[e[22]||(e[22]=r("h4",null,"Agência:",-1)),r("p",null,u(l.produtorData.agencia),1)]),_:1}),a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[e[23]||(e[23]=r("h4",null,"Tipo de Conta:",-1)),r("p",null,u(l.produtorData.tipoConta),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[e[24]||(e[24]=r("h4",null,"Conta:",-1)),r("p",null,u(l.produtorData.conta),1)]),_:1})]),_:1}),r("h4",ie,[e[26]||(e[26]=s(" Dados da CAF ")),a(p,null,{default:o(()=>e[25]||(e[25]=[s("mdi-text-box-multiple-outline")])),_:1})]),a(f,{dense:"",style:{height:"120px",width:"50vw"},class:"border-md pa-2"},{default:o(()=>[a(d,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[e[27]||(e[27]=r("h4",null,"CAF:",-1)),r("p",null,u(l.produtorData.caf),1)]),_:1}),a(d,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[e[28]||(e[28]=r("h4",null,"Validade da CAF:",-1)),r("p",null,u(l.produtorData.validadeCaf),1)]),_:1})]),_:1})],64)}const me=S(re,[["render",ue]]),pe={name:"CadastroProdutor",components:{NavBar:K,NovoProduto:_,ProdutorExpand:me,EditProdutor:le,BtnComeBack:H},data:()=>({dialog:{create:!1,update:!1},search:"",singleExpand:!1,showFilters:!1,products:[],headers:[{text:"Editar",align:"center",value:"edit"},{title:"Descrição do Produto",align:"center",sortable:!0,value:"descricao"},{title:"Especificação do Produto",align:"center",sortable:!0,value:"especificacao"},{title:"Unidade",align:"center",sortable:!0,value:"unidade"},{title:"Preço Médio",align:"center",sortable:!0,value:"precoMedio"}],newItem:{},selectedRow:{},expanded:[]}),computed:{filteredProductors(){return this.products}},methods:{formatPrice(t){return t=Q.formatReal(t),t},async getProducts(){try{const t=await w.get("/public/produtos");console.log(t.data),Array.isArray(t.data)?this.products=t.data:(console.log("A resposta da API não é um Array"),this.products=[])}catch(t){console.log("Error: ",t),this.products=[]}},async createProduct(t){const e=h();console.log(t);try{const l=await w.post("/public/produtos/produto",t);if(console.log(l.data),l.status!==201)throw new Error(`Erro: ${l.status}`);e.success("Produto cadastrado com sucesso!")}catch(l){console.error("Erro: ",l),e.error("Erro ao cadastrar produto: ",l)}finally{this.dialog.create=!1,this.getProducts()}},async updateProduct(t){const e=h();try{const l=await w.put(`/public/produtos/produto/${t.id}`,t);if(console.log(l.data),l.status!==200)throw new Error(`Erro: ${l.status}`);e.success("Produto atualizado com sucesso!")}catch(l){console.error("Erro: ",l),e.error("Erro ao atualizar produto: ",l)}finally{this.dialog.update=!1,this.getProducts()}},onSelectRow(t,e){this.selectedRow={...t},this.dialog[e]=!0}},mounted(){this.getProducts()}},ce={key:0},fe={key:1};function ge(t,e,l,b,y,i){const c=C("NavBar"),n=C("BtnComeBack"),F=C("NovoProduto"),j=C("EditProdutor");return g(),V(G,null,[a(c),a(n),e[19]||(e[19]=r("h1",{style:{color:"#57a340","margin-top":"10px",padding:"30px","font-size":"3rem"}},"Cadastro de Produtos",-1)),a(f,{justify:"center",class:"pr-2"},{default:o(()=>[a(d,{cols:"12"},{default:o(()=>[a(L,{items:i.filteredProductors,headers:t.headers,search:t.search,"single-expand":"",expanded:t.expanded,"onUpdate:expanded":e[3]||(e[3]=m=>t.expanded=m),"fixed-header":!0,height:"700px"},{top:o(()=>[a(f,{class:"mt-2 mb-8 mx-3"},{default:o(()=>[a(d,{cols:"5"},{default:o(()=>[a(D,{class:"border rounded",dense:"",outlined:"","hide-details":"",modelValue:t.search,"onUpdate:modelValue":e[0]||(e[0]=m=>t.search=m),label:"Pesquisar","append-inner-icon":"mdi-magnify",clearable:""},null,8,["modelValue"])]),_:1}),a(d,{class:"text-end",cols:"2"},{default:o(()=>[a(Y,{location:"top start",bordered:"",overlap:""},{default:o(()=>[a(v,{class:"elevation-0",onClick:e[1]||(e[1]=m=>t.showFilters=!t.showFilters)},{default:o(()=>[t.showFilters?(g(),k(p,{key:1,left:"",size:"25px"},{default:o(()=>e[9]||(e[9]=[s("mdi-filter-off")])),_:1})):(g(),k(p,{key:0,size:"25px",left:""},{default:o(()=>e[8]||(e[8]=[s("mdi-filter")])),_:1})),e[10]||(e[10]=s(" FILTROS "))]),_:1})]),_:1})]),_:1}),a(d,{class:"button-group mr-4",align:"end"},{default:o(()=>[a(P,{top:""},{activator:o(({on:m,attrs:E})=>[a(v,I({color:"success",class:"elevation-3 compact-btn ml-3","min-width":"25%",onClick:e[2]||(e[2]=z=>t.dialog.create=!0)},E,J(m)),{default:o(()=>[a(p,{small:"",class:"compact-icon",left:""},{default:o(()=>e[11]||(e[11]=[s("mdi-plus")])),_:1}),e[12]||(e[12]=r("div",{class:"d-flex flex-column compact-btn-text",style:{"font-size":"0.6rem"}},[r("span",null,"Novo"),s(),r("span",null,"Produto")],-1))]),_:2},1040)]),default:o(()=>[e[13]||(e[13]=r("span",null,"Clique para adicionar um produto",-1))]),_:1})]),_:1})]),_:1})]),"item.edit":o(({item:m})=>[a(P,{location:"top"},{activator:o(({props:E})=>[a(v,I({icon:""},E,{onClick:z=>i.onSelectRow(m,"update"),class:"elevation-0"}),{default:o(()=>[a(p,{color:"green"},{default:o(()=>e[14]||(e[14]=[s("mdi-pencil")])),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[e[15]||(e[15]=r("span",null,"Clique para editar um Produtor",-1))]),_:2},1024)]),"item.precoMedio":o(({item:m})=>[m.precoMedio!==null?(g(),V("span",ce,u(i.formatPrice(m.precoMedio)),1)):(g(),V("span",fe,"-"))]),_:2},1032,["items","headers","search","expanded"]),a(B,{modelValue:t.dialog.create,"onUpdate:modelValue":e[5]||(e[5]=m=>t.dialog.create=m)},{default:o(()=>[a(N,{class:"card-form align-self-center",width:"60%"},{default:o(()=>[a(A,{class:"sticky-title title-border"},{default:o(()=>[e[17]||(e[17]=s(" Cadastro de Produto ")),a(U),a(v,{icon:"",class:"btn-close elevation-0",onClick:e[4]||(e[4]=m=>t.dialog.create=!t.dialog.create)},{default:o(()=>[a(p,{prepend:""},{default:o(()=>e[16]||(e[16]=[s(" mdi-close ")])),_:1})]),_:1})]),_:1}),a(F,{currentItem:t.newItem,onSubmit:i.createProduct,dialogAtivo:t.dialog.create},null,8,["currentItem","onSubmit","dialogAtivo"])]),_:1})]),_:1},8,["modelValue"]),a(B,{modelValue:t.dialog.update,"onUpdate:modelValue":e[7]||(e[7]=m=>t.dialog.update=m)},{default:o(()=>[a(N,{class:"card-form align-self-center",width:"60%"},{default:o(()=>[a(A,{class:"sticky-title title-border"},{default:o(()=>[s(" Editar Produtor: "+u(t.selectedRow.id)+" ",1),a(U),a(v,{icon:"",class:"btn-close elevation-0",onClick:e[6]||(e[6]=m=>t.dialog.update=!t.dialog.update)},{default:o(()=>[a(p,{prepend:""},{default:o(()=>e[18]||(e[18]=[s(" mdi-close ")])),_:1})]),_:1})]),_:1}),a(j,{currentItem:t.selectedRow,onSubmit:i.updateProduct,files:t.files},null,8,["currentItem","onSubmit","files"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})],64)}const Pe=S(pe,[["render",ge],["__scopeId","data-v-72dc4401"]]);export{Pe as default};
