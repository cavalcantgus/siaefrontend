import{_ as y,o as s,c as l,w as e,b as o,p as m,O as N,P as S,H as p,d as r,e as $,m as x,A as L,X as g,t as C,F as M,v as P,Y as _,Z as h,z as v,$ as A,r as I,g as w,h as E,a as U,U as F,f as T,a0 as R}from"./index-BU758cL5.js";import{a as B}from"./axios-B7aoVuMY.js";const z={name:"NotificationMenu",props:{notifications:{type:Array,required:!0}},data:()=>({})};function D(t,n,a,d,k,u){return s(),l(A,{offset:"12"},{activator:e(({props:i})=>[o(m,N({icon:""},i,{class:"notifications",onClick:n[0]||(n[0]=c=>t.document.activeElement.blur())}),{default:e(()=>[o(S,{content:a.notifications.length,color:"red",overlap:""},{default:e(()=>[o(p,null,{default:e(()=>n[1]||(n[1]=[r("mdi-bell")])),_:1})]),_:1},8,["content"])]),_:2},1040)]),default:e(()=>[o($,{"min-width":"350px",class:"card-notification",title:"Notificações","max-height":"200px"},{default:e(()=>[a.notifications&&a.notifications.length>0?(s(),l(x,{key:0,class:"actions"},{default:e(()=>[o(m,{class:"btn-view-notify",ripple:!1},{default:e(()=>n[2]||(n[2]=[r("Visualizar")])),_:1})]),_:1})):L("",!0),a.notifications&&a.notifications.length>0?(s(),l(g,{key:1,lines:!1,density:"compact",nav:""},{default:e(()=>[(s(!0),C(M,null,P(a.notifications,(i,c)=>(s(),l(_,{key:c,density:"compact",class:"custom-notification","append-icon":"mdi-alert-circle-outline"},{default:e(()=>[o(h,null,{default:e(()=>[r(v(i.username)+" está aguardando aprovação ",1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(s(),l(g,{key:2,lines:!1,density:"compact",nav:""},{default:e(()=>[o(_,{density:"compact",class:"custom-notification"},{default:e(()=>[o(h,null,{default:e(()=>n[3]||(n[3]=[r("Você não tem notificações")])),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}const j=y(z,[["render",D],["__scopeId","data-v-67a50317"]]);function q(){const t=localStorage.getItem("token");if(!t)return console.log("Token não encontrado"),null;try{const n=t.split(".")[1];if(!n)return console.error("Formato inválido de token"),null;const a=atob(n.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(a).role||""}catch(n){return console.error("Erro ao decodificar o token:",n),null}}async function O(){const t=await B.get("public/users");return console.log(t.data),t.data}async function H(){try{await B.get("/admin/pending-users",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(t=>{this.pendingUsers=t.data}).catch(t=>{console.log("Error: ",t)})}catch(t){console.log("Error: ",t)}return this.pendingUsers}const b={getRoleFromToken:q,getUsers:O,getPendingUsers:H},J={name:"ProfileMenu",props:{profileItems:{type:Array,required:!0}},methods:{handleAction(t){t.action==="logout"?this.logout():t.to&&this.$router.push(t.to)},logout(){console.log("SAIR"),localStorage.removeItem("token"),this.$router.push("/login")}}};function X(t,n,a,d,k,u){return s(),l(A,{offset:"12"},{activator:e(({props:i})=>[o(m,N({icon:""},i,{class:"profile"}),{default:e(()=>[o(p,null,{default:e(()=>n[0]||(n[0]=[r("mdi-account-circle")])),_:1})]),_:2},1040)]),default:e(()=>[o($,{class:"custom-card","min-width":"200px",outlined:"",color:"#57a340",variant:"elevated",dark:""},{default:e(()=>[o(g,{class:"custom-list",lines:!1,density:"compact",nav:""},{default:e(()=>[(s(!0),C(M,null,P(a.profileItems,(i,c)=>(s(),l(_,{key:c,class:"custom-item text-white",onClick:f=>u.handleAction(i)},{default:e(()=>[o(h,null,{default:e(()=>[o(p,null,{default:e(()=>[r(v(i.icon),1)]),_:2},1024),r(" "+v(i.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1})}const Y=y(J,[["render",X],["__scopeId","data-v-48696cbd"]]),Z={name:"NavBar.vue",components:{NotificationMenu:j,ProfileMenu:Y},data:()=>({menu:{admin:{notifications:[],profileItems:[{title:"Meu Perfil",icon:"mdi-account-outline",to:"/profile"},{title:"Dashboard",icon:"mdi-view-dashboard",to:"/admin"},{title:"Sair",icon:"mdi-logout",action:"logout"}]},pendente:{notifications:[],profileItems:[{title:"Meu Perfil",icon:"mdi-account-outline",to:"/profile"},{title:"Dashboard",icon:"mdi-view-dashboard",to:"/admin"},{title:"Sair",icon:"mdi-logout",action:"logout"}]}},role:b.getRoleFromToken()}),methods:{async aggregatingNotifications(){this.menu.admin&&this.role.toLowerCase()==="admin"?this.menu.admin.notifications=await b.getPendingUsers():this.menu.pendente.notifications=[]}},mounted(){this.aggregatingNotifications()}};function G(t,n,a,d,k,u){const i=I("NotificationMenu"),c=I("ProfileMenu");return s(),l(R,{class:"navbar align-center justify-space-between"},{default:e(()=>[o(T,{dense:""},{default:e(()=>[o(w,{cols:"2",class:"d-flex align-center"},{default:e(()=>[o(E,{class:"logo-img",src:"./img/logo (1).svg"}),n[0]||(n[0]=U("h2",{class:"logo-name ml-2"},"SIAE",-1))]),_:1}),o(F),o(w,{cols:"3",class:"d-flex justify-end align-center"},{default:e(()=>{var f,V;return[o(i,{notifications:((f=t.menu[t.role.toLowerCase()])==null?void 0:f.notifications)||[]},null,8,["notifications"]),o(c,{profileItems:(V=t.menu[t.role.toLowerCase()])==null?void 0:V.profileItems},null,8,["profileItems"])]}),_:1})]),_:1})]),_:1})}const W=y(Z,[["render",G],["__scopeId","data-v-ab5a63f3"]]);export{W as N,b as s};
