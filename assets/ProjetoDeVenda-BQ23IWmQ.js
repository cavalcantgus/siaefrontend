import{a as V}from"./axios-B7aoVuMY.js";import{N as H}from"./NavBar-D144UfjL.js";import{C as x,U as E}from"./utilsService-DYeRol40.js";import{_ as A,r as h,o as b,t as j,b as a,w as o,a as l,f as y,g as s,C as B,d as n,p as w,H as g,F as S,v as Q,l as D,c as q,z as i,X as J,A as M,j as z,i as O,K as C,L as G,M as L,u as F,N as X,P as Z,O as k,W as $,T as U,e as R,J as N,U as T}from"./index-B_VDDeOL.js";import{B as _}from"./BtnComeBack-D9fTrtuM.js";const tt={name:"NovoProduto",components:{ConfirmButton:x},props:{onSubmit:Function,currentItem:{type:Object},dialogAtivo:{type:Boolean,required:!0}},data:()=>({totalGeral:0,unidade:"",precoMedio:"",isSubmitting:!1,isDuplicate:!1,products:[],producers:[],items:{itemsProducts:[{produtoId:null,unidade:null,precoMedio:null}],itemsQuantity:[]},quantityWarnings:[],quantityValid:!0,requiredField:[e=>e!=null&&e!==""||"Obrigatório"]}),watch:{dialogAtivo(e){e||this.resetState()},"items.itemsProducts":{handler(e){this.validateQuantity(),this.updateTotalGeral(),e.forEach((t,r)=>{if(t&&t.produtoId){t&&t.produtoId&&(this.isDuplicate=e.some((m,d)=>d!==r&&m.produtoId===t.produtoId));const c=this.products.find(m=>m.id===t.produtoId);c&&(this.items.itemsProducts[r].unidade=c.produto.unidade,this.items.itemsProducts[r].precoMedio=c.produto.precoMedio)}})},deep:!0},"items.itemsQuantity":{handler(){this.validateQuantity(),this.updateTotalGeral()},deep:!0}},computed:{isFormValid(){const e=this.items.itemsProducts.every(t=>t.produtoId&&t.unidade&&t.precoMedio);return!!(this.currentItem.produtorId&&e&&this.quantityValid&&!this.isDuplicate)}},methods:{validateQuantity(){this.quantityWarnings=this.items.itemsProducts.map((e,t)=>{const r=e.produtoId,c=this.items.itemsQuantity[t]||0;if(!r)return null;const m=this.products.find(d=>d.id===r);return m&&c>m.quantidade?(this.quantityValid=!1,`A quantidade inserida excede o limite permitido para ${m.produto.descricao} (${m.quantidade}).`):(this.quantityValid=!0,null)})},formatPrice(e){return e=E.formatReal(e),e},updateTotalGeral(){this.totalGeral=this.items.itemsProducts.reduce((e,t,r)=>{const c=this.items.itemsQuantity[r]||0,m=parseFloat(t.precoMedio)||0;return e+m*c},0).toFixed(2)},addItem(){this.items.itemsProducts.push({produtoId:null,unidade:null,precoMedio:null}),this.items.itemsQuantity.push(null)},removeItem(e){this.items.itemsProducts.splice(e,1),this.items.itemsQuantity.splice(e,1)},resetState(){Object.keys(this.currentItem).forEach(e=>{this.currentItem[e]=null})},async localOnSubmit(){try{const e={...this.currentItem,pesquisasId:this.items.itemsProducts.map(t=>t.produtoId),quantidade:this.items.itemsQuantity};console.log(e),this.onSubmit(e)}catch(e){console.log("Erro: ",e)}},async getResearchs(){try{const e=await V.get("/public/pesquisas");console.log(e.data),Array.isArray(e.data)?(this.products=e.data,console.log(e.data)):(console.log("A resposta da API não é um Array"),this.products=[])}catch(e){console.log("Error: ",e),this.products=[]}},async getProductors(){try{const e=await V.get("/public/produtores");console.log(e.data),this.producers=e.data}catch(e){console.log("Error: ",e),this.producers=[]}}},mounted(){this.getResearchs(),this.getProductors()}},et={class:"pa-3 pr-12 pl-12"},ot={class:"grid-container"},at={key:1,class:"text-start text-error ml-3",style:{"font-size":"0.8rem","font-weight":"bold",width:"100%","margin-top":"-25px","margin-bottom":"20px"}};function lt(e,t,r,c,m,d){const P=h("ConfirmButton");return b(),j("div",et,[a(O,{onSubmit:z(d.localOnSubmit,["prevent"]),ref:"formRef"},{default:o(()=>[l("div",ot,[a(y,{class:"ml-1 w-100"},{default:o(()=>[a(s,{cols:""},{default:o(()=>[a(B,{density:"compact",name:"producer",items:e.producers,"item-title":"nome","item-value":"id",modelValue:r.currentItem.produtorId,"onUpdate:modelValue":t[0]||(t[0]=p=>r.currentItem.produtorId=p),variant:"outlined",rules:e.requiredField,clearable:""},{label:o(()=>t[2]||(t[2]=[l("span",null,[n("Produtor "),l("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["items","modelValue","rules"])]),_:1})]),_:1}),a(y,{class:"w-100",style:{"margin-top":"-50px","margin-left":"-8px"}},{default:o(()=>[a(s,{cols:"12"},{default:o(()=>[a(w,{size:"30px",icon:"",style:{"margin-left":"-26px","margin-bottom":"-85px"},color:"primary",onClick:d.addItem},{default:o(()=>[a(g,{left:"",size:"20px"},{default:o(()=>t[3]||(t[3]=[n("mdi-plus")])),_:1})]),_:1},8,["onClick"]),(b(!0),j(S,null,Q(e.items.itemsProducts,(p,f)=>(b(),j("div",{key:f,class:"grid-second-container"},[a(s,{cols:"",class:""},{default:o(()=>[a(B,{color:e.isDuplicate?"error":"",density:"compact",name:"product",items:e.products,"item-title":"produto.descricao","item-value":"id",modelValue:e.items.itemsProducts[f].produtoId,"onUpdate:modelValue":v=>e.items.itemsProducts[f].produtoId=v,variant:"outlined",rules:e.requiredField,clearable:""},{label:o(()=>t[4]||(t[4]=[l("span",null,[n("Produto "),l("span",{style:{color:"red"}},"*")],-1)])),_:2},1032,["color","items","modelValue","onUpdate:modelValue","rules"])]),_:2},1024),a(s,{cols:"2"},{default:o(()=>[a(D,{density:"compact",name:"unidade",label:"Unidade",modelValue:e.items.itemsProducts[f].unidade,"onUpdate:modelValue":v=>e.items.itemsProducts[f].unidade=v,variant:"outlined",disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(s,{cols:"2"},{default:o(()=>[a(D,{density:"compact",name:"precoMedio",label:"Preço Médio",modelValue:e.items.itemsProducts[f].precoMedio,"onUpdate:modelValue":v=>e.items.itemsProducts[f].precoMedio=v,variant:"outlined",disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(s,{cols:"2"},{default:o(()=>[a(D,{density:"compact",name:"quantidade",label:"Quantidade",modelValue:e.items.itemsQuantity[f],"onUpdate:modelValue":v=>e.items.itemsQuantity[f]=v,variant:"outlined",disabled:e.isDuplicate},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024),a(w,{size:"30px",icon:"",color:"error",style:{"margin-top":"15px"},onClick:v=>d.removeItem(f)},{default:o(()=>[a(g,{size:"20px"},{default:o(()=>t[5]||(t[5]=[n("mdi-delete")])),_:1})]),_:2},1032,["onClick"]),e.quantityWarnings[f]?(b(),q(J,{key:0,color:"error",class:"mt-2 mb-4 ml-4",density:"compact",style:{"font-size":"0.8rem",height:"70px"}},{default:o(()=>[n(i(e.quantityWarnings[f]),1)]),_:2},1024)):M("",!0),e.isDuplicate?(b(),j("span",at,i("Itens duplicados. Por favor, remova-os, ou escolha outro."))):M("",!0)]))),128))]),_:1})]),_:1}),a(y,{class:"w-100",style:{"margin-top":"15px","margin-left":"3px"}},{default:o(()=>[a(s,{cols:"4"},{default:o(()=>[a(D,{"max-width":"170px",density:"compact",name:"dataProjeto",label:"Data do Projeto",type:"date",modelValue:r.currentItem.dataProjeto,"onUpdate:modelValue":t[1]||(t[1]=p=>r.currentItem.dataProjeto=p),variant:"outlined",rules:e.requiredField},null,8,["modelValue","rules"])]),_:1}),a(s,{align:"end",class:"align-self-center"},{default:o(()=>[t[6]||(t[6]=l("h4",null,"Total",-1)),l("span",null,i(d.formatPrice(e.totalGeral)),1)]),_:1})]),_:1})])]),_:1},8,["onSubmit"]),a(y,{class:"justify-end dense pt-6"},{default:o(()=>[a(s,{class:"text-end"},{default:o(()=>[a(C,{location:"top",disabled:d.isFormValid},{activator:o(({props:p})=>[l("span",G(L(p)),[a(P,{color:d.isFormValid?"success":"grey",onConfirm:d.localOnSubmit,loading:e.isSubmitting,disabled:!d.isFormValid||e.isSubmitting},{default:o(()=>t[7]||(t[7]=[n("Salvar")])),_:1},8,["color","onConfirm","loading","disabled"])],16)]),default:o(()=>[t[8]||(t[8]=l("span",null,"Preencha todos os campos obrigatórios (*) para habilitar o botão",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])}const rt=A(tt,[["render",lt],["__scopeId","data-v-6e33e01a"]]),st={name:"EditProduto",components:{ConfirmButton:x},props:{onSubmit:Function,currentItem:{type:Object}},data:()=>({isSubmitting:!1,unidade:[{type:"G",value:"G"},{type:"KG",value:"KG"},{type:"T",value:"T"},{type:"L",value:"L"},{type:"ML",value:"ML"},{type:"UND",value:"UND"},{type:"Maço",value:"Maço"},{type:"Caixas",value:"Caixas"},{type:"Pacotes",value:"Pacotes"},{type:"Fardos",value:"Fardos"},{type:"Sacos",value:"Sacos"}],requiredField:[e=>e!=null&&e!==""||"Obrigatório"]}),computed:{isFormValid(){return!!(this.currentItem.descricao&&this.currentItem.unidade)}},methods:{async localOnSubmit(){this.currentItem.descricao=this.currentItem.descricao.toUpperCase();try{const e={...this.currentItem};this.onSubmit(e)}catch(e){console.log("Erro: ",e)}}}},dt={class:"pa-4 pr-12 pl-12"},it={class:"grid-container"};function nt(e,t,r,c,m,d){const P=h("ConfirmButton");return b(),j("div",dt,[a(O,{onSubmit:z(d.localOnSubmit,["prevent"]),ref:"formRef"},{default:o(()=>[l("div",it,[a(D,{class:"flex-item-nome",density:"compact",name:"nome",modelValue:r.currentItem.descricao,"onUpdate:modelValue":t[0]||(t[0]=p=>r.currentItem.descricao=p),variant:"outlined",rules:e.requiredField,clearable:""},{label:o(()=>t[3]||(t[3]=[l("span",null,[n("Descrição "),l("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["modelValue","rules"]),a(B,{density:"compact",name:"unidade",items:e.unidade,"item-title":"type","item-value":"value",modelValue:r.currentItem.unidade,"onUpdate:modelValue":t[1]||(t[1]=p=>r.currentItem.unidade=p),variant:"outlined",rules:e.requiredField,clearable:""},{label:o(()=>t[4]||(t[4]=[l("span",null,[n("Unidade "),l("span",{style:{color:"red"}},"*")],-1)])),_:1},8,["items","modelValue","rules"]),a(D,{class:"flex-item-especificao",density:"compact",name:"nome",label:"Especificação",modelValue:r.currentItem.especificacao,"onUpdate:modelValue":t[2]||(t[2]=p=>r.currentItem.especificacao=p),variant:"outlined"},null,8,["modelValue"])])]),_:1},8,["onSubmit"]),a(y,{class:"justify-end dense pt-6"},{default:o(()=>[a(s,{class:"text-end"},{default:o(()=>[a(C,{location:"top",disabled:d.isFormValid},{activator:o(({props:p})=>[l("span",G(L(p)),[a(P,{color:d.isFormValid?"success":"grey",onConfirm:d.localOnSubmit,loading:e.isSubmitting,disabled:!d.isFormValid||e.isSubmitting},{default:o(()=>t[5]||(t[5]=[n("Salvar")])),_:1},8,["color","onConfirm","loading","disabled"])],16)]),default:o(()=>[t[6]||(t[6]=l("span",null,"Preencha todos os campos obrigatórios (*) para habilitar o botão",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})])}const ut=A(st,[["render",nt],["__scopeId","data-v-46fa41a0"]]),mt={name:"ProdutorExpand",props:{projetoData:Object},data:()=>({productors:[],headers:[{title:"Arquivo",align:"start",sortable:!0,value:"fileName"},{title:"Tipo",align:"start",sortable:!0,value:"fileType"},{title:"Baixar",align:"start",sortable:!0,value:"download"},{title:"Remover",align:"start",sortable:!0,value:"remove"}]}),methods:{age(e){console.log("Método chamado");const t=new Date,r=new Date(e);let c=t.getFullYear()-r.getFullYear();const m=t.getMonth()-r.getMonth();return(m<0||m===0&&t.getDate()<r.getDate())&&c--,console.log(c),c},formatDate(e){return E.formatDateBr(e)},formatPrice(e){return e=E.formatReal(e),e},getAge(){var m;const e=new Date,t=new Date((m=this.projetoData)==null?void 0:m.dataNascimento);let r=e.getFullYear()-t.getFullYear();const c=e.getMonth()-t.getMonth();(c<0||c===0&&e.getDate()<t.getDate())&&r--,this.projetoData.dataNascimento=r},downloadFile(e){const t=`http://localhost:8080/document/download/${e==null?void 0:e.fileName}`,r=document.createElement("a");r.href=t,r.download=e.fileName,document.body.appendChild(r),r.click(),document.body.removeChild(r)},async deleteFile(e){const t=F();console.log("Id do arquivo: ",e.id);try{const r=await V.delete(`/document/delete/${e.id}/${this.projetoData.id}`);if(r.status!==204)throw new Error("Erro: ",r.status);t.success("Arquivo removido com sucesso!")}catch(r){t.error("Erro ao remover arquivo: ",r)}},async getProductors(){try{const e=await V.get("/public/produtores");console.log(e.data),Array.isArray(e.data)?this.productors=e.data:(console.log("A resposta da API não é um Array"),this.productors=[])}catch(e){console.log("Error: ",e),this.productors=[]}}},mounted(){this.getAge()}},pt={align:"start",class:"pa-2"},ct={class:"d-flex flex-wrap flex-column mr-16",style:{height:"150px",border:"2px solid white",width:"240px"}},ft={class:"d-flex flex-column flex-wrap",align:"start",style:{width:"100%",height:"100%"}},gt={style:{"margin-right":"-100px","padding-left":"5px"}},yt={align:"start",class:"pa-2"},bt={align:"start",class:"pa-2"},Pt={align:"start",class:"pa-2"},vt={align:"start",class:"pa-2"};function ht(e,t,r,c,m,d){return b(),j(S,null,[t[35]||(t[35]=l("h3",{class:"mt-2 mb-2"},"Detalhes do Projeto",-1)),a(y,{dense:"",style:{height:"100px"},class:"border-md pa-2"},{default:o(()=>[a(s,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[0]||(t[0]=l("h4",null,"Data do Projeto:",-1)),l("p",null,i(d.formatDate(r.projetoData.dataProjeto)),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[1]||(t[1]=l("h4",null,"Qtd de Produtos:",-1)),l("p",null,i(r.projetoData.projetoProdutos.length),1)]),_:1}),a(s,{cols:"1",align:"start",class:"h-75"},{default:o(()=>[t[2]||(t[2]=l("h4",null,"Total Geral:",-1)),l("p",null,i(d.formatPrice(r.projetoData.total)),1)]),_:1})]),_:1}),l("h4",pt,[t[4]||(t[4]=n(" Dados do Produto ")),a(g,null,{default:o(()=>t[3]||(t[3]=[n("mdi-file-account")])),_:1})]),a(y,{dense:"",style:{height:"170px"},class:"border-md pa-2"},{default:o(()=>[(b(!0),j(S,null,Q(r.projetoData.projetoProdutos,(P,p)=>(b(),q(s,{key:p,cols:"2",class:"d-flex flex-wrap flex-column mr-16 h-50"},{default:o(()=>[l("div",ct,[l("div",ft,[l("p",gt,"Produto "+i(p+1),1),a(s,{cols:"8",align:"start",style:{"margin-left":"-7px","margin-top":"-6px"}},{default:o(()=>[t[5]||(t[5]=l("span",null,"Descrição:",-1)),l("p",null,i(P.produto.descricao),1),t[6]||(t[6]=l("br",null,null,-1)),t[7]||(t[7]=l("span",null,"Unidade:",-1)),l("p",null,i(P.produto.unidade),1)]),_:2},1024),a(s,{cols:"9",align:"start",class:"mt-4",style:{"margin-left":"-50px"}},{default:o(()=>[t[8]||(t[8]=l("span",null,"Preço Médio:",-1)),l("p",null,i(d.formatPrice(P.produto.precoMedio)),1),t[9]||(t[9]=l("br",null,null,-1)),t[10]||(t[10]=l("span",null,"Quantidade:",-1)),l("p",null,i(P.quantidade),1)]),_:2},1024)])])]),_:2},1024))),128))]),_:1}),l("h4",yt,[t[12]||(t[12]=n(" Dados do Produtor ")),a(g,null,{default:o(()=>t[11]||(t[11]=[n("mdi-file-account")])),_:1})]),a(y,{dense:"",style:{height:"150px"},class:"border-md pa-2"},{default:o(()=>[a(s,{cols:"3",align:"start",class:"h-50"},{default:o(()=>[t[13]||(t[13]=l("h4",null,"Nome:",-1)),l("p",null,i(r.projetoData.produtor.nome),1)]),_:1}),a(s,{cols:"1",align:"start",class:"h-50"},{default:o(()=>[t[14]||(t[14]=l("h4",null,"Idade:",-1)),l("p",null,i(d.age(r.projetoData.produtor.dataNascimento)),1)]),_:1}),a(s,{cols:"3",align:"start",class:"h-50"},{default:o(()=>[t[15]||(t[15]=l("h4",null,"Email:",-1)),l("p",null,i(r.projetoData.produtor.email),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[t[16]||(t[16]=l("h4",null,"Contato:",-1)),l("p",null,i(r.projetoData.produtor.contato),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[t[17]||(t[17]=l("h4",null,"CPF:",-1)),l("p",null,i(r.projetoData.produtor.cpf),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-50"},{default:o(()=>[t[18]||(t[18]=l("h4",null,"RG:",-1)),l("p",null,i(r.projetoData.produtor.rg),1)]),_:1})]),_:1}),l("h4",bt,[t[20]||(t[20]=n(" Endereço ")),a(g,null,{default:o(()=>t[19]||(t[19]=[n("mdi-home")])),_:1})]),a(y,{dense:"",style:{height:"100px"},class:"border-md pa-2"},{default:o(()=>[a(s,{cols:"1",align:"start",class:"h-75"},{default:o(()=>[t[21]||(t[21]=l("h4",null,"Estado:",-1)),l("p",null,i(r.projetoData.produtor.estado),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[22]||(t[22]=l("h4",null,"Município:",-1)),l("p",null,i(r.projetoData.produtor.municipio),1)]),_:1}),a(s,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[23]||(t[23]=l("h4",null,"Endereço:",-1)),l("p",null,i(r.projetoData.produtor.endereco),1)]),_:1}),a(s,{cols:"1",align:"start",class:"h-75"},{default:o(()=>[t[24]||(t[24]=l("h4",null,"CEP:",-1)),l("p",null,i(r.projetoData.produtor.cep),1)]),_:1})]),_:1}),l("h4",Pt,[t[26]||(t[26]=n(" Dados Bancários ")),a(g,null,{default:o(()=>t[25]||(t[25]=[n("mdi-bank")])),_:1})]),a(y,{dense:"",style:{height:"100px",width:"50vw"},class:"border-md pa-2"},{default:o(()=>[a(s,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[27]||(t[27]=l("h4",null,"Banco:",-1)),l("p",null,i(r.projetoData.produtor.banco),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[28]||(t[28]=l("h4",null,"Agência:",-1)),l("p",null,i(r.projetoData.produtor.agencia),1)]),_:1}),a(s,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[29]||(t[29]=l("h4",null,"Tipo de Conta:",-1)),l("p",null,i(r.projetoData.produtor.tipoConta),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[30]||(t[30]=l("h4",null,"Conta:",-1)),l("p",null,i(r.projetoData.produtor.conta),1)]),_:1})]),_:1}),l("h4",vt,[t[32]||(t[32]=n(" Dados da CAF ")),a(g,null,{default:o(()=>t[31]||(t[31]=[n("mdi-text-box-multiple-outline")])),_:1})]),a(y,{dense:"",style:{height:"120px",width:"50vw"},class:"border-md pa-2 mb-2"},{default:o(()=>[a(s,{cols:"3",align:"start",class:"h-75"},{default:o(()=>[t[33]||(t[33]=l("h4",null,"CAF:",-1)),l("p",null,i(r.projetoData.produtor.caf),1)]),_:1}),a(s,{cols:"2",align:"start",class:"h-75"},{default:o(()=>[t[34]||(t[34]=l("h4",null,"Validade da CAF:",-1)),l("p",null,i(d.formatDate(r.projetoData.produtor.validadeCaf)),1)]),_:1})]),_:1})],64)}const Vt=A(mt,[["render",ht]]),jt={name:"CadastroProdutor",components:{NavBar:H,NovoProduto:rt,ProjetoDeVendaExpand:Vt,EditProdutor:ut,BtnComeBack:_,ConfirmButton:x},data:()=>({dialog:{create:!1,update:!1},search:"",singleExpand:!1,showFilters:!1,projects:[],headers:[{text:"Editar",align:"center",value:"edit",width:"40px"},{text:"Remover",align:"center",value:"delete",width:"40px"},{title:"Produtor",align:"center",sortable:!0,value:"produtor.nome"},{title:"Endereço",align:"center",sortable:!0,value:"produtor.endereco",width:"300px"},{title:"CAF",align:"center",sortable:!0,value:"produtor.caf"},{title:"Data Projeto",align:"center",sortable:!0,value:"dataProjeto"},{title:"Total Geral",align:"center",sortable:!0,value:"total"}],newItem:{},selectedRow:{},deleteRow:{},expanded:[]}),computed:{filteredProjects(){return this.projects}},methods:{formatPrice(e){return e=E.formatReal(e),e},formatDate(e){return E.formatData(e)},async getProjects(){try{const e=await V.get("/public/projetos");console.log(e.data),Array.isArray(e.data)?this.projects=e.data:(console.log("A resposta da API não é um Array"),this.projects=[])}catch(e){console.log("Error: ",e),this.projects=[]}},async createProject(e){const t=F();console.log(e);try{const r=await V.post("/public/projetos/projeto",e);if(console.log(r.data),r.status!==201)throw new Error(`Erro: ${r.status}`);t.success("Projeto cadastrado com sucesso!")}catch(r){console.error("Erro: ",r),t.error("Erro ao cadastrar projeto: ",r)}finally{this.dialog.create=!1,this.getProjects()}},async updateProduct(e){const t=F();try{const r=await V.put(`/public/produtos/produto/${e.id}`,e);if(console.log(r.data),r.status!==200)throw new Error(`Erro: ${r.status}`);t.success("Produto atualizado com sucesso!")}catch(r){console.error("Erro: ",r),t.error("Erro ao atualizar produto: ",r)}finally{this.dialog.update=!1,this.getProducts()}},async deleteProduct(e){const t=F();try{const r=await V.delete(`/public/produtos/produto/${e.id}`,e);if(r.status!==204)throw new Error("Erro: ",r.status);t.success("Produto removido com sucesso!")}catch(r){t.error("Erro ao deletar produto: ",r),console.error("Erro: ",r)}finally{this.getProducts()}},onSelectRow(e,t){this.selectedRow={...e},this.dialog[t]=!0},onDeleteRow(e){console.log("Método chamado"),this.deleteRow={...e},this.deleteProduct(this.deleteRow)}},mounted(){this.getProjects()}},wt={colspan:9,style:{"background-color":"#37622a"},class:"text-white"};function Dt(e,t,r,c,m,d){const P=h("NavBar"),p=h("BtnComeBack"),f=h("ConfirmButton"),v=h("ProjetoDeVendaExpand"),W=h("NovoProduto"),Y=h("EditProdutor");return b(),j(S,null,[a(P),a(p),t[21]||(t[21]=l("h1",{style:{color:"#57a340","margin-top":"10px",padding:"30px","font-size":"3rem"}},"Projeto De Venda",-1)),a(y,{justify:"center",class:"pr-2"},{default:o(()=>[a(s,{cols:"12"},{default:o(()=>[a(X,{items:d.filteredProjects,headers:e.headers,search:e.search,"single-expand":"","show-expand":"",expanded:e.expanded,"onUpdate:expanded":t[3]||(t[3]=u=>e.expanded=u),"fixed-header":!0,height:"700px"},{top:o(()=>[a(y,{class:"mt-2 mb-8 mx-3"},{default:o(()=>[a(s,{cols:"5"},{default:o(()=>[a(D,{class:"border rounded",dense:"",outlined:"","hide-details":"",modelValue:e.search,"onUpdate:modelValue":t[0]||(t[0]=u=>e.search=u),label:"Pesquisar","append-inner-icon":"mdi-magnify",clearable:""},null,8,["modelValue"])]),_:1}),a(s,{class:"text-end",cols:"2"},{default:o(()=>[a(Z,{location:"top start",bordered:"",overlap:""},{default:o(()=>[a(w,{class:"elevation-0",onClick:t[1]||(t[1]=u=>e.showFilters=!e.showFilters)},{default:o(()=>[e.showFilters?(b(),q(g,{key:1,left:"",size:"25px"},{default:o(()=>t[9]||(t[9]=[n("mdi-filter-off")])),_:1})):(b(),q(g,{key:0,size:"25px",left:""},{default:o(()=>t[8]||(t[8]=[n("mdi-filter")])),_:1})),t[10]||(t[10]=n(" FILTROS "))]),_:1})]),_:1})]),_:1}),a(s,{class:"button-group mr-4",align:"end"},{default:o(()=>[a(C,{top:""},{activator:o(({on:u,attrs:I})=>[a(w,k({color:"success",class:"elevation-3 compact-btn ml-3","min-width":"25%",onClick:t[2]||(t[2]=K=>e.dialog.create=!0)},I,$(u)),{default:o(()=>[a(g,{small:"",class:"compact-icon",left:""},{default:o(()=>t[11]||(t[11]=[n("mdi-plus")])),_:1}),t[12]||(t[12]=l("div",{class:"d-flex flex-column compact-btn-text",style:{"font-size":"0.6rem"}},[l("span",null,"Novo"),n(),l("span",null,"Projeto")],-1))]),_:2},1040)]),default:o(()=>[t[13]||(t[13]=l("span",null,"Clique para adicionar um projeto",-1))]),_:1})]),_:1})]),_:1})]),"item.edit":o(({item:u})=>[a(C,{location:"top"},{activator:o(({props:I})=>[a(w,k({icon:""},I,{onClick:K=>d.onSelectRow(u,"update"),class:"elevation-0"}),{default:o(()=>[a(g,{color:"green"},{default:o(()=>t[14]||(t[14]=[n("mdi-pencil")])),_:1})]),_:2},1040,["onClick"])]),default:o(()=>[t[15]||(t[15]=l("span",null,"Clique para editar um Projeto",-1))]),_:2},1024)]),"item.delete":o(({item:u})=>[a(C,{location:"top"},{activator:o(({props:I})=>[a(f,k({icon:""},I,{onConfirm:()=>d.onDeleteRow(u),class:"elevation-0"}),{default:o(()=>[a(g,{color:"red"},{default:o(()=>t[16]||(t[16]=[n("mdi-delete")])),_:1})]),_:2},1040,["onConfirm"])]),default:o(()=>[t[17]||(t[17]=l("span",null,"Clique para deletar um Projeto",-1))]),_:2},1024)]),"item.dataProjeto":o(({item:u})=>[l("span",null,i(d.formatDate(u.dataProjeto)),1)]),"item.total":o(({item:u})=>[l("span",null,i(d.formatPrice(u.total)),1)]),"expanded-row":o(({item:u})=>[l("tr",null,[l("td",wt,[n(i(console.log(u))+" ",1),a(v,{projetoData:u},null,8,["projetoData"])])])]),_:2},1032,["items","headers","search","expanded"]),a(U,{modelValue:e.dialog.create,"onUpdate:modelValue":t[5]||(t[5]=u=>e.dialog.create=u),width:"70%"},{default:o(()=>[a(R,{class:"card-form align-self-center",width:"100%"},{default:o(()=>[a(N,{class:"sticky-title title-border"},{default:o(()=>[t[19]||(t[19]=n(" Cadastro de Projeto ")),a(T),a(w,{icon:"",class:"btn-close elevation-0",onClick:t[4]||(t[4]=u=>e.dialog.create=!e.dialog.create)},{default:o(()=>[a(g,{prepend:""},{default:o(()=>t[18]||(t[18]=[n(" mdi-close ")])),_:1})]),_:1})]),_:1}),a(W,{currentItem:e.newItem,onSubmit:d.createProject,dialogAtivo:e.dialog.create},null,8,["currentItem","onSubmit","dialogAtivo"])]),_:1})]),_:1},8,["modelValue"]),a(U,{modelValue:e.dialog.update,"onUpdate:modelValue":t[7]||(t[7]=u=>e.dialog.update=u)},{default:o(()=>[a(R,{class:"card-form align-self-center",width:"60%"},{default:o(()=>[a(N,{class:"sticky-title title-border"},{default:o(()=>[n(" Editar Produtor: "+i(e.selectedRow.id)+" ",1),a(T),a(w,{icon:"",class:"btn-close elevation-0",onClick:t[6]||(t[6]=u=>e.dialog.update=!e.dialog.update)},{default:o(()=>[a(g,{prepend:""},{default:o(()=>t[20]||(t[20]=[n(" mdi-close ")])),_:1})]),_:1})]),_:1}),a(Y,{currentItem:e.selectedRow,onSubmit:d.updateProduct,files:e.files},null,8,["currentItem","onSubmit","files"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})],64)}const qt=A(jt,[["render",Dt],["__scopeId","data-v-08c2a135"]]);export{qt as default};
